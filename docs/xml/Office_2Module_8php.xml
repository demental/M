<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.5.6">
  <compounddef id="Office_2Module_8php" kind="file">
    <compoundname>Module.php</compoundname>
    <innerclass refid="classOffice__Module" prot="public">Office_Module</innerclass>
    <innernamespace refid="namespaceM">M</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal">&lt;?php</highlight></codeline>
<codeline lineno="20"><highlight class="keyword">class<sp/></highlight><highlight class="normal">Office_Module<sp/></highlight><highlight class="keyword">extends</highlight><highlight class="normal"><sp/>Module<sp/>{</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/>function<sp/>__construct($config)<sp/>{</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/>parent::__construct($config);</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal"><sp/>function<sp/>executeAction($action)</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/>$AuthOptions<sp/>=<sp/>PEAR::getStaticProperty(</highlight><highlight class="stringliteral">&apos;Office&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;global&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/>$userOpt<sp/>=<sp/>$AuthOptions[</highlight><highlight class="stringliteral">&apos;auth&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">($userOpt<sp/>&amp;&amp;<sp/>!User::getInstance(</highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">)-&gt;isLoggedIn())<sp/>{</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>SecurityException(</highlight><highlight class="stringliteral">&apos;Not<sp/>enough<sp/>credential<sp/>to<sp/>enter<sp/>here<sp/>(current<sp/>credential<sp/>=<sp/>&apos;</highlight><highlight class="normal">.$userLevel.</highlight><highlight class="charliteral">&apos;)&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>parent::executeAction($action);</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">protected</highlight><highlight class="normal"><sp/>function<sp/>generateOptions()</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$AuthOptions<sp/>=<sp/>PEAR::getStaticProperty(</highlight><highlight class="stringliteral">&apos;Office&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;global&apos;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>$userOpt<sp/>=<sp/>$AuthOptions[</highlight><highlight class="stringliteral">&apos;auth&apos;</highlight><highlight class="normal">];</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$opt<sp/>=<sp/>array(</highlight><highlight class="stringliteral">&apos;all&apos;</highlight><highlight class="normal">=&gt;PEAR::getStaticProperty(</highlight><highlight class="stringliteral">&apos;Module&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;global&apos;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$options<sp/>=<sp/>array(</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;caching&apos;</highlight><highlight class="normal"><sp/>=&gt;(MODE==</highlight><highlight class="stringliteral">&apos;developpement&apos;</highlight><highlight class="normal">?</highlight><highlight class="keyword">false</highlight><highlight class="normal">:</highlight><highlight class="keyword">true</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;cacheDir&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>$opt[</highlight><highlight class="stringliteral">&apos;all&apos;</highlight><highlight class="normal">][</highlight><highlight class="stringliteral">&apos;cacheDir&apos;</highlight><highlight class="normal">].</highlight><highlight class="stringliteral">&apos;/config/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lifeTime&apos;</highlight><highlight class="normal"><sp/>=&gt;<sp/>null,</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fileNameProtection&apos;</highlight><highlight class="normal">=&gt;</highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;automaticSerialization&apos;</highlight><highlight class="normal">=&gt;</highlight><highlight class="keyword">true</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>$optcache<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>Cache_Lite($options);</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!$moduleopt<sp/>=<sp/>$optcache-&gt;</highlight><highlight class="keyword">get</highlight><highlight class="normal">($modulename.($userOpt?User::getInstance(</highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">)-&gt;getId():</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)))<sp/><sp/>{</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(@include_once<sp/>$this-&gt;_path.$modulename.</highlight><highlight class="stringliteral">&apos;.conf.php&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal">(!is_array($config))<sp/>{$config=array();}</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$moduleopt<sp/>=<sp/>MArray::array_merge_recursive_unique($opt,<sp/>$config);</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$moduleopt=$opt;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$useropt[</highlight><highlight class="stringliteral">&apos;all&apos;</highlight><highlight class="normal">][</highlight><highlight class="stringliteral">&apos;tablesToShow&apos;</highlight><highlight class="normal">]<sp/>=<sp/>Mreg::get(</highlight><highlight class="stringliteral">&apos;authHelper&apos;</highlight><highlight class="normal">)-&gt;getTablesToShow(User::getInstance(</highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">));</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$moduleopt<sp/>=<sp/>MArray::array_merge_recursive_unique($moduleopt,<sp/>$useropt);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>$optcache-&gt;save($moduleopt);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>$moduleopt;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="67"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/raynald/Documents/Taf/Eclipse/m4php5/Office/Module.php"/>
  </compounddef>
</doxygen>
